(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[219],{3273:function(e,t,r){Promise.resolve().then(r.bind(r,8800))},8800:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=r(7437),l=r(2265);function s(e){let{nodes:t,selectedNodeId:r,onNodeSelect:s,onNodeUpdate:n,onNodeAdd:i,onNodeRemove:o,onNodeReorder:c}=e,[d,u]=(0,l.useState)(new Set),[m,f]=(0,l.useState)(null);(0,l.useRef)(null);let x=e=>{let t=new Set(d);t.has(e)?t.delete(e):t.add(e),u(t)},b=(e,t)=>{f(t),e.dataTransfer.effectAllowed="move"},h=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},g=(e,r)=>{if(e.preventDefault(),m&&m!==r){let e=t.findIndex(e=>e.id===r);-1!==e&&c(m,e)}f(null)},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=d.has(e.id),i=r===e.id,c=e.children&&e.children.length>0;return(0,a.jsxs)("div",{className:"select-none",children:[(0,a.jsxs)("div",{className:"flex items-center py-1 px-2 cursor-pointer hover:bg-gray-100 rounded ".concat(i?"bg-blue-100 border-l-2 border-blue-500":""),style:{paddingLeft:"".concat(20*t+8,"px")},onClick:()=>s(e.id),draggable:!0,onDragStart:t=>b(t,e.id),onDragOver:h,onDrop:t=>g(t,e.id),children:[(0,a.jsx)("button",{className:"w-4 h-4 mr-2 flex items-center justify-center",onClick:t=>{t.stopPropagation(),c&&x(e.id)},children:c?l?"▼":"▶":"•"}),(0,a.jsx)("button",{className:"w-4 h-4 mr-2 flex items-center justify-center",onClick:t=>{t.stopPropagation(),n(e.id,{visible:!e.visible})},children:e.visible?"\uD83D\uDC41":"\uD83D\uDC41‍\uD83D\uDDE8"}),(0,a.jsx)("button",{className:"w-4 h-4 mr-2 flex items-center justify-center",onClick:t=>{t.stopPropagation(),n(e.id,{locked:!e.locked})},children:e.locked?"\uD83D\uDD12":"\uD83D\uDD13"}),(0,a.jsx)("span",{className:"mr-2",children:"image"===e.type?"\uD83D\uDDBC️":"vector"===e.type?"\uD83D\uDCD0":"text"===e.type?"\uD83D\uDCDD":"\uD83D\uDD37"}),(0,a.jsx)("span",{className:"flex-1 text-sm truncate",children:e.name}),(0,a.jsx)("input",{type:"range",min:"0",max:"100",value:e.opacity,className:"w-16 h-2 mr-2",onChange:t=>{t.stopPropagation(),n(e.id,{opacity:parseInt(t.target.value)})}}),(0,a.jsx)("button",{className:"w-4 h-4 text-red-500 hover:text-red-700",onClick:t=>{t.stopPropagation(),o(e.id)},children:"\uD83D\uDDD1️"})]}),c&&l&&(0,a.jsx)("div",{children:e.children.map(e=>p(e,t+1))})]},e.id)};return(0,a.jsxs)("div",{className:"w-full h-full bg-white border border-gray-300 rounded-lg overflow-auto",children:[(0,a.jsx)("div",{className:"p-2 border-b border-gray-200 bg-gray-50",children:(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700",children:"Scene Layers"})}),(0,a.jsx)("div",{className:"p-1",children:0===t.length?(0,a.jsx)("div",{className:"text-center text-gray-500 py-4 text-sm",children:"No layers yet. Generate an image to start editing."}):t.map(e=>p(e))})]})}function n(e){let{nodes:t,selectedNodeId:r,onNodeUpdate:s,onNodeSelect:n,canvasWidth:i,canvasHeight:o}=e,c=(0,l.useRef)(null),[d,u]=(0,l.useState)(!1),[m,f]=(0,l.useState)({x:0,y:0}),[x,b]=(0,l.useState)(!1),[h,g]=(0,l.useState)(null),p=(0,l.useCallback)(()=>{let e=c.current;if(!e)return;let r=e.getContext("2d");r&&(r.clearRect(0,0,i,o),t.forEach(e=>{if(e.visible){if(r.save(),r.globalAlpha=e.opacity/100,r.translate(e.transform.x,e.transform.y),r.rotate(e.transform.rotation*Math.PI/180),r.scale(e.transform.scaleX,e.transform.scaleY),"image"===e.type&&e.content.src){let t=new Image;t.onload=()=>{r.drawImage(t,0,0)},t.src=e.content.src}else if("vector"===e.type&&e.content.svg)r.fillStyle="#000",r.fillRect(0,0,100,100);else if("text"===e.type&&e.content.text){var t,a,l;r.fillStyle=(null===(t=e.content.style)||void 0===t?void 0:t.color)||"#000",r.font="".concat((null===(a=e.content.style)||void 0===a?void 0:a.fontSize)||16,"px ").concat((null===(l=e.content.style)||void 0===l?void 0:l.fontFamily)||"Arial"),r.fillText(e.content.text,0,0)}r.restore()}}))},[t,i,o]);(0,l.useEffect)(()=>{p()},[p]);let v=()=>{u(!1),b(!1),g(null)},y=(e,r)=>{for(let a=t.length-1;a>=0;a--){let l=t[a];if(!l.visible)continue;let s=l.transform.x,n=l.transform.y,i=100*l.transform.scaleX,o=100*l.transform.scaleY;if(e>=s&&e<=s+i&&r>=n&&r<=n+o)return l}return null},j=(e,t,r)=>{let a=e.transform.x,l=e.transform.y,s=100*e.transform.scaleX,n=100*e.transform.scaleY;return t>=a+s-8&&r>=l+n-8?"bottom-right":t>=a&&t<=a+8&&r>=l&&r<=l+8?"top-left":null};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("canvas",{ref:c,width:i,height:o,className:"border border-gray-300 cursor-crosshair",onMouseDown:e=>{var t;let r=null===(t=c.current)||void 0===t?void 0:t.getBoundingClientRect();if(!r)return;let a=e.clientX-r.left,l=e.clientY-r.top,s=y(a,l);if(s){n(s.id);let e=j(s,a,l);if(e){b(!0),g(e),f({x:a,y:l});return}u(!0),f({x:a,y:l})}else n(null)},onMouseMove:e=>{var a;if(!r)return;let l=null===(a=c.current)||void 0===a?void 0:a.getBoundingClientRect();if(!l)return;let n=e.clientX-l.left,i=e.clientY-l.top;if(d){let e=n-m.x,a=i-m.y,l=t.find(e=>e.id===r);l&&s(r,{transform:{...l.transform,x:l.transform.x+e,y:l.transform.y+a}}),f({x:n,y:i})}else if(x&&h){let e=n-m.x,a=i-m.y,l=t.find(e=>e.id===r);if(l){let t=l.transform.scaleX,n=l.transform.scaleY;h.includes("right")&&(t+=e/100),h.includes("left")&&(t-=e/100),h.includes("bottom")&&(n+=a/100),h.includes("top")&&(n-=a/100),s(r,{transform:{...l.transform,scaleX:Math.max(.1,t),scaleY:Math.max(.1,n)}})}f({x:n,y:i})}},onMouseUp:v,onMouseLeave:v}),(()=>{if(!r)return null;let e=t.find(e=>e.id===r);return e?(0,a.jsxs)("div",{className:"absolute border-2 border-blue-500 pointer-events-none",style:{left:e.transform.x,top:e.transform.y,width:100*e.transform.scaleX,height:100*e.transform.scaleY,transform:"rotate(".concat(e.transform.rotation,"deg)")},children:[(0,a.jsx)("div",{className:"absolute -top-1 -left-1 w-2 h-2 bg-blue-500 border border-white cursor-nw-resize"}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 border border-white cursor-ne-resize"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -left-1 w-2 h-2 bg-blue-500 border border-white cursor-sw-resize"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-blue-500 border border-white cursor-se-resize"})]}):null})()]})}function i(e){let{onAssetUpload:t,onAssetInsert:r,className:s=""}=e,n=(0,l.useRef)(null),[i,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)([]),u=e=>{e&&Array.from(e).forEach(e=>{let r=e.type.startsWith("image/")?"image":"vector";t(e,r);let a=new FileReader;a.onload=t=>{var a;let l=null===(a=t.target)||void 0===a?void 0:a.result,s={id:Math.random().toString(36).substr(2,9),name:e.name,src:l,type:r};d(e=>[...e,s])},a.readAsDataURL(e)})},m=(e,t)=>{e.dataTransfer.setData("application/json",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy"};return(0,a.jsxs)("div",{className:"w-full h-full ".concat(s),children:[(0,a.jsx)("div",{className:"border-2 border-dashed rounded-lg p-4 text-center transition-colors ".concat(i?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:e=>{e.preventDefault(),o(!1)},onDrop:e=>{e.preventDefault(),o(!1),u(e.dataTransfer.files)},onClick:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.click()},children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 mb-2",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsx)("p",{className:"text-sm",children:"Drag & drop assets here or click to upload"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Supports images (PNG, JPG) and vectors (SVG, AI)"})]})}),(0,a.jsx)("input",{ref:n,type:"file",multiple:!0,accept:"image/*,.svg,.ai",className:"hidden",onChange:e=>u(e.target.files)}),c.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Uploaded Assets"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:c.map(e=>(0,a.jsxs)("div",{className:"relative group cursor-move border border-gray-200 rounded p-2 hover:border-blue-300 transition-colors",draggable:!0,onDragStart:t=>m(t,e),title:"Drag to canvas to insert: ".concat(e.name),children:["image"===e.type?(0,a.jsx)("img",{src:e.src,alt:e.name,className:"w-full h-16 object-cover rounded"}):(0,a.jsx)("div",{className:"w-full h-16 bg-gray-100 rounded flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["\uD83D\uDCD0 ",e.name]})}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all rounded flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"Drag to insert"})})]},e.id))})]})]})}function o(e){let{sourceImage:t,onViewGenerated:r,className:s=""}=e,[n,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)("front"),[d,u]=(0,l.useState)({}),m=async e=>{if(t){i(!0);try{await new Promise(e=>setTimeout(e,2e3));let a=f(t,e);u(t=>({...t,[e]:a})),r(a,e)}catch(e){console.error("Error generating view:",e)}finally{i(!1)}}},f=(e,t)=>{let r=document.createElement("canvas");r.width=512,r.height=512;let a=r.getContext("2d");switch(t){case"front":a.fillStyle="#4ecdc4";break;case"back":a.fillStyle="#45b7d1";break;case"left":a.fillStyle="#96ceb4";break;case"right":a.fillStyle="#feca57";break;case"top":a.fillStyle="#ff9ff3";break;case"bottom":a.fillStyle="#54a0ff";break;case"3quarter":a.fillStyle="#5f27cd";break;case"profile":a.fillStyle="#00d2d3";break;default:a.fillStyle="#ff6b6b"}return a.fillRect(0,0,512,512),a.fillStyle="#fff",a.font="24px Arial",a.textAlign="center",a.fillText("".concat(t.toUpperCase()," VIEW"),256,256),r.toDataURL("image/png")},x=e=>{c(e),d[e]||m(e)};return(0,a.jsxs)("div",{className:"w-full h-full ".concat(s),children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Multi-View Generation"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Generate the same object from different angles while preserving style"})]}),t&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Source Image"}),(0,a.jsx)("div",{className:"w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:(0,a.jsx)("img",{src:t,alt:"Source",className:"w-full h-full object-cover"})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Select View Angle"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{key:"front",label:"Front View",icon:"\uD83D\uDC64"},{key:"back",label:"Back View",icon:"\uD83D\uDC64"},{key:"left",label:"Left Side",icon:"\uD83D\uDC48"},{key:"right",label:"Right Side",icon:"\uD83D\uDC49"},{key:"top",label:"Top View",icon:"⬆️"},{key:"bottom",label:"Bottom View",icon:"⬇️"},{key:"3quarter",label:"3/4 View",icon:"\uD83D\uDD04"},{key:"profile",label:"Profile",icon:"\uD83D\uDC41️"}].map(e=>(0,a.jsxs)("button",{className:"p-3 rounded-lg border-2 transition-all ".concat(o===e.key?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"),onClick:()=>x(e.key),disabled:n,children:[(0,a.jsx)("div",{className:"text-2xl mb-1",children:e.icon}),(0,a.jsx)("div",{className:"text-xs font-medium",children:e.label})]},e.key))})]}),n&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,a.jsxs)("span",{className:"text-sm text-blue-700",children:["Generating ",o," view..."]})]})}),Object.keys(d).length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Generated Views"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:Object.entries(d).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:r,alt:"".concat(t," view"),className:"w-full h-20 object-cover rounded border border-gray-200"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all rounded flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity font-medium",children:t.toUpperCase()})})]},t)})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",onClick:()=>m(o),disabled:n||!t,children:["Generate ",o," View"]}),(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",onClick:()=>u({}),children:"Clear All"})]})]})}function c(){var e;let[t,r]=(0,l.useState)([]),[c,d]=(0,l.useState)(null),[u,m]=(0,l.useState)("layers"),[f,x]=(0,l.useState)({width:800,height:600}),b=(0,l.useRef)(null),h=(0,l.useCallback)(e=>{d(e)},[]),g=(0,l.useCallback)((e,t)=>{r(r=>r.map(r=>r.id===e?{...r,...t}:r))},[]),p=(0,l.useCallback)((e,t)=>{let a={...t,id:Math.random().toString(36).substr(2,9)};e?r(t=>t.map(t=>t.id===e?{...t,children:[...t.children||[],a]}:t)):r(e=>[...e,a])},[]),v=(0,l.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e)),c===e&&d(null)},[c]),y=(0,l.useCallback)((e,t)=>{r(r=>{let a=r.findIndex(t=>t.id===e);if(-1===a)return r;let l=r[a],s=r.filter(t=>t.id!==e);return s.splice(t,0,l),s})},[]),j=(0,l.useCallback)((e,t)=>{let r=new FileReader;r.onload=r=>{var a;let l=null===(a=r.target)||void 0===a?void 0:a.result;p(null,{type:"image"===t?"image":"vector",name:e.name,visible:!0,locked:!1,opacity:100,transform:{x:Math.random()*(f.width-100),y:Math.random()*(f.height-100),scaleX:1,scaleY:1,rotation:0},content:{src:"image"===t?l:void 0,svg:"vector"===t?l:void 0}})},r.readAsDataURL(e)},[f,p]),N=(0,l.useCallback)((e,t)=>{console.log("Insert asset:",e,"at position:",t)},[]),w=(0,l.useCallback)((e,t)=>{p(null,{type:"image",name:"Generated ".concat(t," view"),visible:!0,locked:!1,opacity:100,transform:{x:Math.random()*(f.width-100),y:Math.random()*(f.height-100),scaleX:1,scaleY:1,rotation:0},content:{src:e}})},[f,p]),D=(0,l.useCallback)(e=>{var t;e.preventDefault();let r=null===(t=b.current)||void 0===t?void 0:t.getBoundingClientRect();if(!r)return;let a=e.clientX-r.left,l=e.clientY-r.top;try{let t=JSON.parse(e.dataTransfer.getData("application/json")),r={type:t.type,name:t.name,visible:!0,locked:!1,opacity:100,transform:{x:a-50,y:l-50,scaleX:1,scaleY:1,rotation:0},content:{src:t.src}};p(null,r)}catch(e){console.error("Error parsing dropped asset:",e)}},[p]),k=(0,l.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"},[]);return(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-gray-100",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-800",children:"Advanced Image Editor"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Canvas Size:"}),(0,a.jsx)("input",{type:"number",value:f.width,onChange:e=>x(t=>({...t,width:parseInt(e.target.value)||800})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm"}),(0,a.jsx)("span",{className:"text-gray-500",children:"\xd7"}),(0,a.jsx)("input",{type:"number",value:f.height,onChange:e=>x(t=>({...t,height:parseInt(e.target.value)||600})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm"})]}),(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Main"})]})]})}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,a.jsx)("button",{className:"flex-1 px-4 py-3 text-sm font-medium ".concat("layers"===u?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),onClick:()=>m("layers"),children:"Layers"}),(0,a.jsx)("button",{className:"flex-1 px-4 py-3 text-sm font-medium ".concat("assets"===u?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),onClick:()=>m("assets"),children:"Assets"}),(0,a.jsx)("button",{className:"flex-1 px-4 py-3 text-sm font-medium ".concat("multiview"===u?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"),onClick:()=>m("multiview"),children:"Multi-View"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:["layers"===u&&(0,a.jsx)(s,{nodes:t,selectedNodeId:c,onNodeSelect:h,onNodeUpdate:g,onNodeAdd:p,onNodeRemove:v,onNodeReorder:y}),"assets"===u&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(i,{onAssetUpload:j,onAssetInsert:N})}),"multiview"===u&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(o,{sourceImage:c&&(null===(e=t.find(e=>e.id===c))||void 0===e?void 0:e.content.src)||null,onViewGenerated:w})})]})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-4",children:(0,a.jsx)("div",{ref:b,onDrop:D,onDragOver:k,className:"relative",children:(0,a.jsx)(n,{nodes:t,selectedNodeId:c,onNodeUpdate:g,onNodeSelect:h,canvasWidth:f.width,canvasHeight:f.height})})})})]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=3273)}),_N_E=e.O()}]);